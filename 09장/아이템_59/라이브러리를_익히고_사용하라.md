# [라이브러리를 익히고 사용하라]

무작위 정수 하나를 생성하고 싶을 때, 많은 프로그래머가 다음과 같이 직접 메소드를 만들었다고 하는 경우가 있을 것이다.
```JAVA
// 범위는 0부터 n사이의 값이다.
static Random rnd = new Random();

static int random(int n) {
    return Math.abs(rnd.nextInt()) % n;
}

//예시를 위해 선택한 범위 내에서 무작위 수를 백만개 생성한 다음, 그 중 중간 값보다 작은 숫자의 수를 출력한다.
public static void main(String[] args){
	int n = 2 * (Integer.MAX_VALUE / 3);
    int low = 0;
    for (int i = 0; i < 1000000; i++)
    	if (random(n) < n/2)
        	low++;
    System.out.println(low);
}
```
괜찮은 듯 보여도 문제를 세 가지나 내포하고 있다.  
1. n이 그리 크지않은 2의 제곱수라면 얼마 지나지 않아 같은 수열이 반복된다.  
2. n이 2의 제곱수가 아니라면 몇몇 숫자가 평균적으로 더 자주 반환된다.  
> random 메서드가 이상적으로 동작한다면 기대한 값은 약 50만 이지만, 실제로 돌려보면 666,666에 가까운 값을 얻는다. 실제로 돌려보면 666,6666에 가까운 값을 얻는다. 즉, 무작위로 생성된 수 중에서 2/3 가량이 중간값보다 낮은 쪽으로 쏠린 것이다.

3. 지정한 범위 '바깥'의 수가 종종 튀어 나올 수 있다.  
> rnd.nextInt() 가 반환한 값을 Math.abs를 이용해 음수가 아닌 정수로 매핑하기 때문이다.  
> nextInt()가 Integer.MIN_VALUE를 반환하면 Math.abs 가 Interger.MIN_VALUE를 반환하고 나머지 연산자가 음수를 반환해버린다.(n이 2의 제곱수가 아닐 때)
```JAVA
System.out.println(Math.abs(Integer.MIN_VALUE) % 11);
```

이렇게 되면 프로그램은 실패하게 되고, 문제를 재현하기도 어렵게 된다.  

## 표준 라이브러리를 사용하자. 
위 결함을 직접 해결하려면 여러 이론에 조예가 깊어야하지만, 그럴 필요가 없다. 이미 `Random.nextInt(n)` 가 위의 문제들을 이미 해결해놓았기 때문이다. 자바 7 이후부터는 `Random`이 아닌 `ThreadLocalRandom` 을 사용하자. 속도도 더 빠르고 더 고품질의 무작위 수를 생성해준다. 

## 표준 라이브러리를 사용하여 얻는 이점
* 표준 라이브러리를 사용하면 그 코드를 작성한 전문가의 지식과 여러분보다 앞서 사용한 다른 프로그래머들의 경험을 활용할 수 있다.  
* 핵심적인 일과 크게 관련 없는 문제를 해결하느라 시간을 허비하지 않아도 된다.  
* 따로 노력하지 않아도 성능이 지속해서 개선된다.  
* 기능이 점점 많아진다. 라이브러리에 부족한 부분이 있다면 개발자 커뮤티니에서 이야기가 나오고 논의된 후 다음 릴리즈에 해당 기능이 추가되곤 한다.  
* 우리가 작성한 코드가 많은 사람에게 낯익은 코드가 된다. 이로 인해 가독성도 좋고, 유지보수 및 재활용하기 좋은 코드가 된다.  


## 표준 라이브러리의 메이저 릴리즈를 잘 참고하자.
위 이점에 따르면 표준 라이브러리의 기능을 사용하는 것이 좋지만 잘 사용하지 않는 이유는 아마 라이브러리에 그런 기능이 있는지 모르기 때문일 것이다. 메이저 릴리즈마다 주목할 만한 수많은 기능이 추가되고, 그에 대한 설명이 웹페이지에 공시되므로 잘 참고하자.  

라이브러리가 너무 방대하여 벅찰수도 있지만 적어도 **`java.lang`, `java.util`. `java.io` 하위 패키지들**에는 익숙해지는 것이 좋다.



## 정리
* 나만의 특별한 기능이 아니라면 누군가 이미 구현해 놨을 가능성이 크므로 표준 라이브러리를 잘 찾아보고 사용하자. 코드 품질이 높아질 것이다.